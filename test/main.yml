---
- name: Bring up docker containers
  hosts: localhost
  gather_facts: false
  vars:
    inventory:
      - name: rabbitmq_host_1
        image: "ubuntu:16.04"
      - name: rabbitmq_host_2
        image: "ubuntu:16.04"
    ansible_python_interpreter: '/usr/bin/python3'
  roles:
    - role: provision_docker
      provision_docker_inventory: "{{ inventory }}"

- name: Run rabbitmq role Tests
  hosts: docker_containers
  roles:
    - role: rabbitmq
      rabbitmq_users:
        - name: foo
          password: bar
      ansible_python_interpreter: /usr/bin/python
  tasks:
    - name: Test ports
      command: 'echo "hello world"'

